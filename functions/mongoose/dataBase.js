const { Guild } = require('discord.js');
const MusicModel = require('../../models/Distube');
const PlaylistModel = require('../../models/PlayList');

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/**
 * 
 * @param {Guild} guild Obtiene el nuevo servidor al que se une el bot y carga las bases de datos.
 */
async function LoadDatabase(guild) {





    // Aquí poner su lógica...






}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/**
 * 
 * @param {Guild} guild Obtiene el servidor de salida y elimina las bases de datos.
 * @returns {Promise<boolean>}
 */
async function DeleteGuildDatabase(guild) {

    try {

        const guildMusicData = await MusicModel.findOne({ serverId: guild.id });

        if (guildMusicData) {
            await guildMusicData.deleteOne();
        }

        const guildMusicPlaylist = await PlaylistModel.find().then((s) => {
            return s?.filter((s) => s?.serverId === guild.id);
        });

        if (guildMusicPlaylist?.length > 0) {
            await PlaylistModel.deleteMany({ serverId: guild.id });
        }

        return true;

    } catch (e) {
        console.log(e);
        return false;
    }
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
module.exports = {
    LoadDatabase,
    DeleteGuildDatabase
}